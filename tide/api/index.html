



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for Single Digital Presence">
      
      
        <link rel="canonical" href="https://dpc-sdp.github.io/sdp-docs/tide/api/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>API - Single Digital Presence</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#tide-api" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://dpc-sdp.github.io/sdp-docs/" title="Single Digital Presence" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Single Digital Presence
            </span>
            <span class="md-header-nav__topic">
              API
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/dpc-sdp/sdp-docs" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    dpc-sdp/sdp-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="About" class="md-tabs__link">
        About
      </a>
    
  </li>

      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../bay/" title="Bay" class="md-tabs__link">
          Bay
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tide" class="md-tabs__link md-tabs__link--active">
          Tide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../ripple/" title="Ripple" class="md-tabs__link">
          Ripple
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../development/" title="Development" class="md-tabs__link">
          Development
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://dpc-sdp.github.io/sdp-docs/" title="Single Digital Presence" class="md-nav__button md-logo">
      
        <img src="../../images/logo.svg" width="48" height="48">
      
    </a>
    Single Digital Presence
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/dpc-sdp/sdp-docs" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    dpc-sdp/sdp-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../terminology/" title="Terminology" class="md-nav__link">
      Terminology
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Bay
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Bay
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bay/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bay/onboarding/" title="Onboarding" class="md-nav__link">
      Onboarding
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Tide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Tide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modules/" title="Modules" class="md-nav__link">
      Modules
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        API
      </label>
    
    <a href="./" title="API" class="md-nav__link md-nav__link--active">
      API
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-jsonapi" title="Why JSONAPI?" class="md-nav__link">
    Why JSONAPI?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal-jsonapi-and-related-modules" title="Drupal JSONAPI and related modules" class="md-nav__link">
    Drupal JSONAPI and related modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints" title="Endpoints" class="md-nav__link">
    Endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-flow" title="Request flow" class="md-nav__link">
    Request flow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-to-end-url-resolution" title="End-to-end URL resolution" class="md-nav__link">
    End-to-end URL resolution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#router-api-endpoint" title="Router API endpoint" class="md-nav__link">
    Router API endpoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-entities" title="Referenced entities" class="md-nav__link">
    Referenced entities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal-caching" title="Drupal caching" class="md-nav__link">
    Drupal caching
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sites-sections/" title="Sites and sections" class="md-nav__link">
      Sites and sections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fields-components/" title="Fields and components" class="md-nav__link">
      Fields and components
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setup/" title="Content repository setup" class="md-nav__link">
      Content repository setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Ripple
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Ripple
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ripple/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ripple/components/" title="Components" class="md-nav__link">
      Components
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ripple/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ripple/search/" title="Search" class="md-nav__link">
      Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ripple/content-rendering-pipeline/" title="Content rendering pipeline" class="md-nav__link">
      Content rendering pipeline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ripple/setup/" title="Setup new site" class="md-nav__link">
      Setup new site
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/workflow/" title="Development Workflow" class="md-nav__link">
      Development Workflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/code-review/" title="Code review" class="md-nav__link">
      Code review
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/local-development-environment/" title="Local development environment" class="md-nav__link">
      Local development environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/back-end-coding-standards/" title="Back-end coding standards" class="md-nav__link">
      Back-end coding standards
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/front-end-coding-standards/" title="Front-end coding standards" class="md-nav__link">
      Front-end coding standards
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/automated-builds/" title="Automated builds" class="md-nav__link">
      Automated builds
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/module-development/" title="Module Development" class="md-nav__link">
      Module Development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/release/" title="Release management" class="md-nav__link">
      Release management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/accessibility/" title="Accessibility" class="md-nav__link">
      Accessibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/readme-files/" title="README.md files" class="md-nav__link">
      README.md files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development/documentation/" title="Maintaining this documentation" class="md-nav__link">
      Maintaining this documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-jsonapi" title="Why JSONAPI?" class="md-nav__link">
    Why JSONAPI?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal-jsonapi-and-related-modules" title="Drupal JSONAPI and related modules" class="md-nav__link">
    Drupal JSONAPI and related modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints" title="Endpoints" class="md-nav__link">
    Endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-flow" title="Request flow" class="md-nav__link">
    Request flow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-to-end-url-resolution" title="End-to-end URL resolution" class="md-nav__link">
    End-to-end URL resolution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#router-api-endpoint" title="Router API endpoint" class="md-nav__link">
    Router API endpoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenced-entities" title="Referenced entities" class="md-nav__link">
    Referenced entities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal-caching" title="Drupal caching" class="md-nav__link">
    Drupal caching
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="tide-api">Tide API<a class="headerlink" href="#tide-api" title="Permanent link">&para;</a></h1>
<p>Content API is built from a set of contributed modules and custom code provided
through <a href="https://github.com/dpc-sdp/tide_api">Tide API</a> module.</p>
<h2 id="why-jsonapi">Why JSONAPI?<a class="headerlink" href="#why-jsonapi" title="Permanent link">&para;</a></h2>
<p>Why we selected <a href="http://jsonapi.org/">JSONAPI standard</a> over generic REST 
provided by Drupal core:</p>
<ul>
<li>JSON is a standard of REST, a subset of generic REST rules. </li>
<li>JSONAPI allows to query individual items and collections. 
  Drupal JSONAPI module automatically exposes entities as endpoints. Because 
  most of functionality is implement as entities in Drupal 8, there is no 
  need for custom code to expose required features. </li>
<li>JSONAPI is a newer format</li>
<li>JSONAPI will be included in Drupal core.
  Documentation on using Drupal JSONAPI module: <a href="https://www.drupal">https://www.drupal</a>
  .org/docs/8/modules/json-api </li>
</ul>
<p>It is assumed that API consumers support the following:</p>
<ul>
<li>Can traverse data.</li>
<li>Can cache based on response headers. </li>
<li>Can resolve relationships by following links. </li>
</ul>
<h2 id="drupal-jsonapi-and-related-modules">Drupal JSONAPI and related modules<a class="headerlink" href="#drupal-jsonapi-and-related-modules" title="Permanent link">&para;</a></h2>
<p><a href="https://www.drupal.org/project/jsonapi">jsonapi</a> - main module that exposes 
entities as endpoints and provides support for REST operations. </p>
<p><a href="https://www.drupal.org/project/jsonapi_extras">jsonapi_extras</a> - helper module to alter
JSONAPI config: endpoints prefix (we are using <code>/api/v1</code>) and enable/disable
endpoints for automatically exposed entities (we use this to limit access to
internal entities). </p>
<h2 id="endpoints">Endpoints<a class="headerlink" href="#endpoints" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>Component</th>
<th>Content API endpoint</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>route</td>
<td><code>/api/v1/route?alias=&lt;alias&gt;</code></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>main menu</td>
<td><code>/api/v1/menu_link_content/menu_link_content?filter[menu_name][value]=main</code></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>banner</td>
<td>TBD</td>
<td>If exposed as a block - use block-based endpoint. If exposed as a content field - use entity endpoint with inclusion.</td>
</tr>
<tr>
<td>4</td>
<td>breadcrumbs</td>
<td>TBD</td>
<td>Not supported out of the box. May need to use main menu to build breadcrumbs by FEF.</td>
</tr>
<tr>
<td>5</td>
<td>content</td>
<td><code>/api/v1/page/&lt;UUID&gt;?include=field_page_paragraph</code></td>
<td>Can be combined with 6</td>
</tr>
<tr>
<td>6</td>
<td>related content</td>
<td><code>/api/v1/page/&lt;UUID&gt;?include=field_related_content</code></td>
<td>Can be combined with 5</td>
</tr>
<tr>
<td>7</td>
<td>share block</td>
<td><code>/api/v1/block_content/share_block</code></td>
<td>Content is static HTML</td>
</tr>
<tr>
<td>8</td>
<td>was this page helpful</td>
<td>TBD</td>
<td>Posting of webform submissions is not supported. Custom module may be required.</td>
</tr>
<tr>
<td>9</td>
<td>footer main menu</td>
<td><code>/api/v1/menu_link_content/menu_link_content?filter[menu_name][value]=main</code></td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>copyright</td>
<td><code>/api/v1/block_content/copyright</code></td>
<td>Content is static HTML</td>
</tr>
<tr>
<td>11</td>
<td>footer menu</td>
<td><code>/api/v1/menu_link_content/menu_link_content?filter[menu_name][value]=footer</code></td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>Sites information</td>
<td><code>/api/v1/taxonomy_term/sites</code></td>
<td></td>
</tr>
<tr>
<td>13</td>
<td>Router</td>
<td><code>/api/v1/router</code></td>
<td>Alias lookup. May be required for ad-hoc queries from FEF.</td>
</tr>
</tbody>
</table>
<p>Page example that may use these endpoints
<img alt="Page built using API data" src="../../assets/api-page-example.png" /></p>
<h2 id="request-flow">Request flow<a class="headerlink" href="#request-flow" title="Permanent link">&para;</a></h2>
<p>The diagram below demonstrates how a single page is assembled by VueJS when
hitting multiple endpoints.</p>
<p>VueJS retrieves site information and caches it internally until the next cache
clear. Each consumer site has only site UUID (taxonomy term UUID from <code>Site</code>
vocabulary) hardcoded. The rest of configuration comes from taxonomy term: logo,
slogan, footer text, main menu name, footer menu name. This information is later
used in follow-up requests to retrieve relevant information.</p>
<p><em>Content API Content</em>, <em>Content API Menu</em>, and <em>Content API Block</em> are shown
here as separated endpoints (they are indeed separate), but are handled by the
same internal entity controller from JSONAPI Drupal module. The content is
filtered by <em>Content API Filter</em> based on provided site and path query
parameters. If no site or path is provided the request is considered invalid and
an error response is returned. <em>Content API Filter</em> is a thin layer (e.g.
request event listener) in front of all JSONAPI endpoints. For example, if the
content exists, but is not assigned to a site or section, it is considered as
non-existing content when accessed from this site.</p>
<p><em>Internal Router</em> is a mechanism to lookup internal path by provided alias.
There is a similar functionality with a <em>Router Endpoint</em>, but it resolves
aliases without additional Drupal-to-Drupal request.</p>
<p><a href="../../assets/api-parallel-requests.png"> <img alt="" src="../../assets/api-parallel-requests.png" /> </a></p>
<h2 id="end-to-end-url-resolution">End-to-end URL resolution<a class="headerlink" href="#end-to-end-url-resolution" title="Permanent link">&para;</a></h2>
<p>The diagram below describes how URL requested by a web browser is resolved by
Drupal and served by VueJS. It covers both front-end and back-end mechanisms.</p>
<p>To leverage JSONAPI module in Drupal, we are using <em>API Router</em> to resolve
requested paths to a set of information about the route (UUID, content type,
path, alias). This information then used by <em>Client API path builder</em> to
assemble a path to then send a second request to the JSONAPI endpoint.</p>
<p>It is important to note that due to how content links can be provided within
content, the path resolution within <em>API Router</em> should be able to find the best
match from either path or alias provided. For example,
paths <code>about-us</code>, <code>/about-us</code>, <code>node/123</code>, <code>/node/123</code> should all resolve to
UUID of <em>About Us</em> page. When matched entity found, <em>API Router</em> also checks if it
has the specified site assigned and returns an error if this path is not
available. Also, <em>API Router</em> has all lookups cached in Drupal's dynamic cache, 
which is tagged with cache tags (so that the cache for path is cleared
when entity is updated).</p>
<p><a href="../../assets/api-end-to-end-url-resolution.png"> <img alt="" src="../../assets/api-end-to-end-url-resolution.png" /> </a></p>
<h2 id="router-api-endpoint">Router API endpoint<a class="headerlink" href="#router-api-endpoint" title="Permanent link">&para;</a></h2>
<p>To control content aliases from Drupal and resolve requests
coming from Browser into FEF, a special <em>Router</em> endpoint exists to perform a
lookup on provided path. Because the provided path can be either internal Drupal
path or an alias, the lookup searches through all existing aliases and internal
paths. </p>
<p>When non-existing alias is provided, the endpoint returns an error according to
JSONAPI specification. </p>
<p><em>Router API</em> also allows to filter by site if site URL query parameter is
provided. </p>
<h2 id="referenced-entities">Referenced entities<a class="headerlink" href="#referenced-entities" title="Permanent link">&para;</a></h2>
<p>JSONAPI supports including referenced entities in response by using <code>include</code>
query parameter and a comma-separated list of entity reference fields. For
example, <code>/api/v1/page/&lt;UUID&gt;?include=field_page_paragraph</code>.</p>
<h2 id="drupal-caching">Drupal caching<a class="headerlink" href="#drupal-caching" title="Permanent link">&para;</a></h2>
<p>Response headers pass-through Drupal-generated cache tags. This means that 
reverse proxies can bind to Drupal cache tags and invalidate their caches
as soon as Drupal caches become invalid.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../modules/" title="Modules" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Modules
              </span>
            </div>
          </a>
        
        
          <a href="../sites-sections/" title="Sites and sections" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Sites and sections
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 Department of Premier and Cabinet of Victoria
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/dpc-sdp" class="md-footer-social__link fa fa-github-alt"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>